<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LLM System Design Deep Dive</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0f172a;
            color: #e2e8f0;
            margin: 0;
            padding: 48px 20px 72px;
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
        }

        header {
            margin-bottom: 32px;
        }

        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        header p {
            color: #94a3b8;
            line-height: 1.6;
        }

        .panel {
            background: rgba(15, 23, 42, 0.92);
            border: 1px solid rgba(148, 163, 184, 0.18);
            border-radius: 18px;
            padding: 28px;
            margin-bottom: 28px;
            box-shadow: 0 24px 40px rgba(8, 47, 73, 0.45);
        }

        h2 {
            font-size: 1.6rem;
            margin-top: 0;
        }

        h3 {
            font-size: 1.1rem;
            margin-top: 20px;
            margin-bottom: 12px;
            color: #cbd5f5;
        }

        ul {
            margin: 0;
            padding-left: 20px;
            line-height: 1.65;
            color: #cbd5f5;
        }

        .diagram {
            margin: 18px 0;
            padding: 20px;
            border-radius: 14px;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.25), rgba(14, 165, 233, 0.25));
            color: #0f172a;
            font-weight: 600;
            line-height: 1.6;
        }

        .qa {
            margin-top: 18px;
            padding: 18px 20px;
            border-radius: 14px;
            background: rgba(79, 70, 229, 0.12);
            border: 1px solid rgba(99, 102, 241, 0.28);
        }

        .qa strong {
            display: block;
            margin-bottom: 8px;
            color: #f8fafc;
        }

        code {
            font-family: 'Fira Code', 'Cascadia Code', 'Consolas', monospace;
            background: rgba(148, 163, 184, 0.14);
            padding: 2px 6px;
            border-radius: 6px;
            color: #cbd5f5;
        }

        .two-column {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 22px;
        }

        .concept-card {
            margin-bottom: 32px;
            border-radius: 22px;
            padding: 32px;
            background: radial-gradient(circle at top left, rgba(79, 70, 229, 0.4), rgba(30, 64, 175, 0.05));
            border: 1px solid rgba(99, 102, 241, 0.35);
            box-shadow: 0 32px 60px rgba(30, 64, 175, 0.25);
            position: relative;
            overflow: hidden;
        }

        .concept-card::after {
            content: '';
            position: absolute;
            top: -120px;
            right: -80px;
            width: 320px;
            height: 320px;
            background: radial-gradient(circle, rgba(56, 189, 248, 0.35), transparent 60%);
            filter: blur(0px);
        }

        .concept-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 26px;
            position: relative;
            z-index: 1;
        }

        .concept-block {
            background: rgba(15, 23, 42, 0.7);
            border-radius: 18px;
            padding: 22px;
            border: 1px solid rgba(148, 163, 184, 0.2);
            box-shadow: inset 0 0 0 1px rgba(148, 163, 184, 0.12);
        }

        .concept-block h3 {
            margin-top: 0;
            color: #f8fafc;
            font-size: 1.2rem;
        }

        .concept-block p,
        .concept-block ul {
            color: #cbd5f5;
            line-height: 1.6;
        }

        .concept-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: rgba(251, 191, 36, 0.2);
            color: #fde68a;
            padding: 6px 14px;
            border-radius: 999px;
            font-weight: 600;
            letter-spacing: 0.02em;
            margin-bottom: 18px;
        }

        .action-chip {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: rgba(56, 189, 248, 0.2);
            color: #bae6fd;
            padding: 6px 12px;
            border-radius: 999px;
            font-size: 0.85rem;
            margin-top: 12px;
        }

        .nav-link {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            margin-top: 40px;
            font-weight: 600;
            color: #38bdf8;
            text-decoration: none;
        }

        @media (max-width: 720px) {
            body {
                padding: 32px 16px 56px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>LLM System Design Interview Vault</h1>
            <p>Answer architecture-heavy LLM questions with confidence: outline ingestion, retrieval, orchestration, safety, monitoring, and scaling. Each section mirrors how senior candidates whiteboard real-world generative AI systems.</p>
        </header>

        <section class="concept-card">
            <span class="concept-badge">Experience Blueprint</span>
            <h2 style="margin-top:0;margin-bottom:18px;font-size:1.9rem;color:#f8fafc;">ML Repository Command Center</h2>
            <div class="concept-grid">
                <div class="concept-block">
                    <h3>ML Repository</h3>
                    <p>Anchor the knowledge base with a dedicated ML repo inside the codebase. Link theoretical question banks, formula sheets, and cheatcards right into your docs sidebar for instant recall.</p>
                    <div class="action-chip">üîó <a href="../conventional_ml/index.html" style="color:#bae6fd;text-decoration:none;font-weight:600;">Jump to Theory Vault</a></div>
                </div>
                <div class="concept-block">
                    <h3>Think-in-Canvas Studio</h3>
                    <p>Embed a whiteboard canvas (Excalidraw / tldraw) so candidates can sketch system flows, loss surfaces, or attention maps. Autosave doodles alongside problem notes for future retros.</p>
                    <div class="action-chip">üñäÔ∏è <a href="https://excalidraw.com" target="_blank" rel="noopener" style="color:#bae6fd;text-decoration:none;font-weight:600;">Open Drawing Pad</a></div>
                </div>
                <div class="concept-block">
                    <h3>Streak Calendar Pulse</h3>
                    <p>Mirror the main tracker on the right rail‚Äîtoggle a ‚ÄúSolve‚Äù button to bump the counter, celebrate daily wins, and sync with your LeetCode streak via local storage or API.</p>
                    <div class="action-chip">üî• <span>Auto-sync with streak_ui calendar</span></div>
                </div>
                <div class="concept-block">
                    <h3>Problem Space</h3>
                    <ul>
                        <li><strong>How-to-think tips:</strong> distilled heuristics plus mental models.</li>
                        <li><strong>Pseudo-code:</strong> Python snippets for core patterns.</li>
                        <li><strong>Arrays &amp; Substrings:</strong> deep links to full practice playlists on external sites.</li>
                    </ul>
                    <div class="action-chip">üìö <a href="../index.html#practice" style="color:#bae6fd;text-decoration:none;font-weight:600;">Browse Topic Drilldowns</a></div>
                </div>
            </div>
        </section>

        <section class="panel">
            <h2>1. End-to-End Architecture Blueprint</h2>
            <div class="diagram">
                Data Lake (docs, FAQs, tickets) ‚Üí Chunking & Embeddings ‚Üí Vector Store (hybrid ANN + keyword) ‚Üí Retrieval Service ‚Üí Prompt Orchestrator ‚Üí LLM Gateway (routing / caching) ‚Üí Post-process (guardrails, re-rank) ‚Üí Client Apps
            </div>
            <div class="two-column">
                <div>
                    <h3>Retrieval Layer</h3>
                    <ul>
                        <li>Hybrid search (BM25 + dense vector) with re-ranking (Cross-encoder / ColBERT) for precision.</li>
                        <li>Freshness strategy: streaming ingestion hook ‚Üí incremental embeddings, asynchronous backfills.</li>
                        <li>Multi-tenant isolation: namespace per customer, ACL on indices.</li>
                    </ul>
                </div>
                <div>
                    <h3>Prompt Orchestration</h3>
                    <ul>
                        <li>Template contracts with variables, safety disclaimers, and structured outputs (JSON schema).</li>
                        <li>Tool/SKU routing using context (classification) ‚Üí choose best-performing prompt variant.</li>
                        <li>Guardrail stack: profanity filters, PII scrubbers, deterministic validators.</li>
                    </ul>
                </div>
            </div>
        </section>

        <section class="panel">
            <h2>2. Model Strategy & Routing</h2>
            <h3>Model Portfolio</h3>
            <ul>
                <li>Mix of hosted APIs (GPT-4 class) and self-hosted open weights (Llama 3, Mistral) for cost/risk balance.</li>
                <li>Fine-tuned adapters (LoRA/QLoRA) for domain tone; distillation for latency-sensitive channels.</li>
            </ul>
            <h3>Routing Logic</h3>
            <ul>
                <li>Classifier decides between <code>general-purpose</code>, <code>code</code>, or <code>analysis</code> route.</li>
                <li>Token budgeter estimates cost, short-circuits to smaller model when context is compact.</li>
                <li>Fallback: cache hit ‚Üí deterministic output; else degrade gracefully to retrieval-only answer.</li>
            </ul>
        </section>

        <section class="panel">
            <h2>3. Latency, Cost & Reliability Guards</h2>
            <div class="two-column">
                <div>
                    <h3>Latency Optimization</h3>
                    <ul>
                        <li>Streaming responses via server-sent events for perceived speed.</li>
                        <li>Prompt compression: dynamic truncation, summary cache, semantic deduplication.</li>
                        <li>Speculative decoding (draft model + verifier) where platform allows.</li>
                    </ul>
                </div>
                <div>
                    <h3>Cost Management</h3>
                    <ul>
                        <li>Token accounting dashboard (cost per user, per feature) with budget alerts.</li>
                        <li>Batching background jobs, offline generation of canned responses.</li>
                        <li>Nightly price simulation to flag runaway prompts.</li>
                    </ul>
                </div>
            </div>
            <h3>Reliability</h3>
            <ul>
                <li>Circuit breakers on upstream model errors; fallback to templated responses.</li>
                <li>Multi-region deployment, warm standby vector stores, automated failover.</li>
                <li>Chaos drills: simulate provider outage, vector DB degradation.</li>
            </ul>
        </section>

        <section class="panel">
            <h2>4. Evaluation & Monitoring Stack</h2>
            <div class="two-column">
                <div>
                    <h3>Offline Evaluation</h3>
                    <ul>
                        <li>Golden set with human-labeled answers; metrics: BLEU/ROUGE limited, prefer LLM-as-judge + rubric.</li>
                        <li>Bias and safety evaluation harness (toxicity, hallucination score, jailbreak detectors).</li>
                        <li>Prompt regression tests: ensure new prompt retains historical pass cases.</li>
                    </ul>
                </div>
                <div>
                    <h3>Online Monitoring</h3>
                    <ul>
                        <li>User feedback loop (thumbs up/down) with reason codes to drive re-ranking.</li>
                        <li>Latency, cost, error rates, retrieval depth metrics in shared dashboard (Grafana/Datadog).</li>
                        <li>Content moderation queue fed by classifier confidence thresholds.</li>
                    </ul>
                </div>
            </div>
            <div class="qa">
                <strong>Interview Tip:</strong>
                When asked ‚ÄúHow do you detect hallucinations?‚Äù, outline retrieval match score thresholds, consistency checks across multiple generations, and human review sampling (e.g., 5% of traffic) with targeted escalation flows.
            </div>
        </section>

        <section class="panel">
            <h2>5. Safety, Compliance & Governance</h2>
            <ul>
                <li>PII redaction pre-embedding; store hashes/tokens instead of raw sensitive data.</li>
                <li>Policy engine to filter disallowed content (HIPAA, FINRA). Maintain audit logs of prompts/responses.</li>
                <li>Watermarking / traceability: tag outputs with model + prompt version for forensic analysis.</li>
                <li>Human-in-the-loop workflows for high-risk categories; integrate with Zendesk/Salesforce for manual review.</li>
            </ul>
        </section>

        <section class="panel">
            <h2>6. Interview Q&A Patterns</h2>
            <div class="qa">
                <strong>Design a RAG system for customer support.</strong>
                <ul>
                    <li>Discuss ingestion (ticketing systems, product docs), chunking strategy (semantic boundaries vs. sliding windows).</li>
                    <li>Vector DB selection (FAISS, Pinecone, Elastic). Mention metadata filters for product tier, locale.</li>
                    <li>Escalation: if confidence &lt; threshold, escalate to human with suggested snippets.</li>
                </ul>
            </div>
            <div class="qa">
                <strong>How to keep prompts up to date?</strong>
                <ul>
                    <li>Prompt store with versioning, automatic A/B testing, rollback on quality dip.</li>
                    <li>Telemetry-driven iteration: capture failure categories, run prompt sweeps nightly.</li>
                </ul>
            </div>
            <div class="qa">
                <strong>Explain fine-tuning vs. retrieval trade-offs.</strong>
                <ul>
                    <li>Fine-tuning improves tone/system behavior but risks staleness and cost; retrieval keeps knowledge fresh.</li>
                    <li>Hybrid approach: fine-tuned base for style, RAG for facts, lightweight adapters for domain jargon.</li>
                </ul>
            </div>
        </section>

        <section class="panel">
            <h2>7. Scaling the Team & Operations</h2>
            <ul>
                <li>Platform mindset: shared tooling for prompt engineers, evaluators, data curators.</li>
                <li>Model registry for prompts, embeddings, finetune artifacts; enforce approvals before production.</li>
                <li>Incident management runbooks for hallucination spikes, provider outages, prompt injection attacks.</li>
            </ul>
        </section>

        <a class="nav-link" href="../index.html">‚Üê Back to ML Playbooks</a>
    </div>
</body>
</html>
